!function(r){"use strict";r(document).ready(function(){var d;r(document).on("click",".yz-edit-activity, .yz-edit-post",function(e){if(e.preventDefault(),!r(".yz-edit-activity.loading,.yz-edit-post.loading")[0]){var i=r(this),n=i.parents("li").attr("id").split("-")[1],o=i.attr("data-activity-type");if(!i.hasClass("loading")){i.addClass("loading"),d=i,r("#youzer-edit-activity-wrapper");var t={action:"yz_get_edit_activity_form",yz_edit_activity_nonce:Youzer.security_nonce,activity_id:n,activity_type:o};r.post(Youzer.ajax_url,t,function(e){if((e=r.parseJSON(e)).remove_button)return d.remove(),void r.yz_DialogMsg("error",e.error);i.attr("data-loaded","true"),i.removeClass("loading");var a=r(e.form);if(e.privacy&&a.find('select.yz-activity-privacy option[value="'+e.privacy+'"]').attr("selected",!0),e.tagged_friends&&(console.log(e.tagged_friends),a.find(".yz-tagged-users").append(e.tagged_friends),0!=a.find(".yz-tagged-user").length&&a.find(".yz-tagged-users").fadeIn()),e.mood&&(a.find(".yz-feeling-title").text(e.mood.title),a.find('input[name="mood_type"]').val(e.mood.type),a.find(".yz-feeling-selected-items").append(e.mood.content).fadeIn(),a.find(".yz-wall-feeling").addClass("yz-activity-feeling-selected")),jQuery.isFunction(r.fn.niceSelect)&&a.find('select:not([multiple="multiple"])').niceSelect(),r("body").append(a),a.find("form").attr("action",""),a.find('input[name="post_type"]')[0]||a.find(".yz-wall-options").append('<input type="hidden" value="'+o+'" name="post_type" />'),a.find('input:radio[name="post_type"]').first().trigger("change"),a.find("#whats-new-post-in-box").remove(),a.find(".yz-wall-options").hide(),a.find(".yz-wall-attchments")[0]&&a.find(".yz-wall-actions").detach().insertAfter(a.find(".yz-wall-attchments")),"activity_giphy"==o&&e.meta.giphy_image&&a.find(".yz-wall-giphy-form .yz-wall-cf-item").hide(1,function(){a.find(".yz-selected-giphy-item").show(1).css("display","inline-block").prepend('<img  src="'+e.meta.giphy_image+'" alt="">'),a.find('.yz-selected-giphy-item input[name="giphy_image"]').val(e.meta.giphy_image)}),a.find('textarea[name="status"]').val(e.content),"activity_comment"==o&&"on"==e.comments_emojis||"activity_comment"!=o&&"on"==e.posts_emojis?jQuery().emojioneArea?a.find(".yz-wall-textarea").emojioneArea({pickerPosition:"bottom",autocomplete:!0,saveEmojisAs:"image",events:{ready:function(){this.editor.textcomplete([{id:"yz_mentions",match:/\B@([\-\d\w]*)$/,search:function(t,e){var a=bp.mentions.users;e(r.map(a,function(e){return 0===e.ID.indexOf(t)||0===e.name.indexOf(t)?e:null}))},template:function(e){return'<img src="'+e.image+'" /><span class="username">@'+e.ID+"</span><small>"+e.name+"</small>"},replace:function(e){return"@"+e.ID+"&nbsp;"},cache:!0,index:1}])}}}):(r("<script/>",{rel:"text/javascript",src:Youzer.assets+"js/emojionearea.min.js"}).appendTo("head"),r("<link/>",{rel:"stylesheet",href:Youzer.assets+"css/emojionearea.min.css"}).appendTo("head")):a.find(".yz-load-emojis").remove(),a.find(".yz-wall-post").attr({class:"yz-update-post","data-activity-type":o,"data-activity-id":n}).text(Youzer.save_changes),r.each(e.meta,function(e,t){a.find('.yz-wall-cf-input[name="'+e+'"]').val(t)}),"hide"==e.attachments?a.find(".yz-wall-upload-btn").remove():a.find(".yz-form-attachments").html(e.attachments),e.url_preview){var t=a.find(".yz-lp-prepost");t.attr("data-loaded",!0),r.yz_set_live_preview_form(t,e.url_preview)}a.css({position:"absolute",top:r(document).scrollTop()+100}),r(".yz-modal-overlay")[0]?r(".yz-modal-overlay").fadeIn():r("body").append('<div class="yz-modal-overlay"></div>')}).fail(function(e,t,a){return i.removeClass("loading"),r.yz_DialogMsg("error",Youzer.unknown_error),!1})}}}),r(document).on("click",".yz-update-post",function(e){e.preventDefault();r(this).attr("data-activity-type");var a=r(this),i=r(this).text(),t=r(this).closest("#yz-wall-form"),n=d.parent().hasClass("activity-meta")||d.parent().hasClass("yz-activity-tools")?"activity":"comment",o={};if(!a.hasClass("loading")){a.addClass("loading"),a.html('<i class="fas fa-spinner fa-spin"></i>'),jQuery.each(t.serializeArray(),function(e,t){"_"!==t.name.substr(0,1)&&"whats-new"!==t.name.substr(0,9)&&(o[t.name]?jQuery.isArray(o[t.name])?o[t.name].push(t.value):o[t.name]=new Array(o[t.name],t.value):o[t.name]=t.value)});var s=r.extend({action:"yz_save_activity_edit_form",yz_edit_activity_nonce:t.find('input[name="yz_edit_activity_nonce"]').val(),activity_id:r(this).data("activity-id"),content:t.find(".yz-wall-textarea").val(),target:n},o);r.ajax({type:"POST",url:ajaxurl,data:s,success:function(e){if(r.yz_isJSON(e)){var t=r.parseJSON(e);if(t.error)return a.removeClass("loading"),a.text(i),t.remove_modal&&(r.yzea_hide_modal(a),d.remove()),void r.yz_DialogMsg("error",t.error)}"comment"==n&&t.content&&r("li#acomment-"+s.activity_id).find(".acomment-content").first().html("<p>"+t.content+"</p>").show(),"activity"==n&&(r("li#activity-"+s.activity_id).replaceWith(e),r("li#activity-"+s.activity_id).hasClass("activity_slideshow")&&r.youzer_sliders_init()),r.yzea_hide_modal(a)}})}}),r(document).on("click","#yz-edit-activity-form .yz-delete-attachment",function(e){var t=r(this).closest(".yz-attachment-item").attr("data-item-id");t&&r(document).find("#yz-edit-activity-form .yz-wall-attachments").append('<input type="hidden" name="delete_attachments[]" value="'+t+'" >')}),r.yzea_hide_modal=function(e){r(".yz-modal-overlay").fadeOut(300,function(){e.closest(".yz-modal").fadeOut(300,function(){r(this).remove()})})}})}(jQuery);