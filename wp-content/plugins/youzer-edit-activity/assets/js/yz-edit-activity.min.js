!function(c){"use strict";c(document).ready(function(){var d;c(document).on("click",".yz-edit-activity, .yz-edit-post",function(t){if(t.preventDefault(),!c(".yz-edit-activity.loading,.yz-edit-post.loading")[0]){var n=c(this),s=n.parents("li").attr("id").split("-")[1],o=n.attr("data-activity-type"),r=!0;if(!n.hasClass("loading")){n.addClass("loading"),d=n,c("#youzer-edit-activity-wrapper");var e={action:"yz_get_edit_activity_form",yz_edit_activity_nonce:Youzer.security_nonce,activity_id:s,activity_type:o};c.post(Youzer.ajax_url,e,function(t){if((t=c.parseJSON(t)).remove_button)return d.remove(),void c.yz_DialogMsg("error",t.error);var a=c(t.form);if(c("body").append(a.hide()),t.privacy&&a.find('select.yz-activity-privacy option[value="'+t.privacy+'"]').attr("selected",!0),t.tagged_friends&&(a.find(".yz-tagged-users").append(t.tagged_friends),0!=a.find(".yz-tagged-user").length&&a.find(".yz-tagged-users").fadeIn()),t.mood&&(a.find(".yz-feeling-title").text(t.mood.title),a.find('input[name="mood_type"]').val(t.mood.type),a.find(".yz-feeling-selected-items").append(t.mood.content).fadeIn(),a.find(".yz-wall-feeling").addClass("yz-activity-feeling-selected")),jQuery.isFunction(c.fn.niceSelect)&&a.find('select:not([multiple="multiple"])').niceSelect(),a.find("form").attr("action",""),a.find('input[name="post_type"]')[0]||a.find(".yz-wall-options").append('<input type="hidden" value="'+o+'" name="post_type" />'),a.find('input:radio[name="post_type"]').first().trigger("change"),"activity_comment"==o&&"on"==t.comment_attachments&&(a.find(".yz-upload-attachments").removeAttr("accept"),a.find(".yz-wall-upload-btn").fadeIn()),a.find("#whats-new-post-in-box").remove(),a.find(".yz-wall-options").hide(),a.find(".yz-wall-attchments")[0]&&a.find(".yz-wall-actions").detach().insertAfter(a.find(".yz-wall-attchments")),"activity_giphy"==o&&t.meta.giphy_image&&a.find(".yz-wall-giphy-form .yz-wall-cf-item").hide(1,function(){a.find(".yz-selected-giphy-item").show(1).css("display","inline-block").prepend('<img  src="'+t.meta.giphy_image+'" alt="">'),a.find('.yz-selected-giphy-item input[name="giphy_image"]').val(t.meta.giphy_image)}),a.find('textarea[name="status"]').val(t.content),"activity_comment"==o&&"on"==t.comments_emojis||"activity_comment"!=o&&"on"==t.posts_emojis?(r=!0,jQuery().emojioneArea?a.find(".yz-wall-textarea").emojioneArea({pickerPosition:"bottom",autocomplete:!0,saveEmojisAs:"image",events:{ready:function(){this.editor.textcomplete([{id:"yz_mentions",match:/\B@([\-\d\w]*)$/,search:function(e,t){var a=bp.mentions.users;t(c.map(a,function(t){return 0===t.ID.indexOf(e)||0===t.name.indexOf(e)?t:null}))},template:function(t){return'<img src="'+t.image+'" /><span class="username">@'+t.ID+"</span><small>"+t.name+"</small>"},replace:function(t){return"@"+t.ID+"&nbsp;"},cache:!0,index:1}])}}}):(c("<script/>",{rel:"text/javascript",src:Youzer.assets+"js/emojionearea.min.js"}).appendTo("head"),c("<link/>",{rel:"stylesheet",href:Youzer.assets+"css/emojionearea.min.css"}).appendTo("head"))):a.find(".yz-load-emojis").remove(),a.find(".yz-wall-post").attr({class:"yz-update-post","data-activity-type":o,"data-activity-id":s}).text(Youzer.save_changes),c.each(t.meta,function(t,e){a.find('.yz-wall-cf-input[name="'+t+'"]').val(e)}),"hide"==t.attachments?a.find(".yz-wall-upload-btn").remove():(yz_load_attachments||(c("<script/>",{rel:"text/javascript",src:Youzer.assets+"js/yz-attachments.min.js"}).appendTo("head"),c("<link/>",{rel:"stylesheet",href:Youzer.assets+"css/yz-attachments.min.css"}).appendTo("head"),yz_load_attachments=!0),a.find(".yz-form-attachments").html(t.attachments)),t.url_preview){var e=a.find(".yz-lp-prepost");e.attr("data-loaded",!0),c.yz_set_live_preview_form(e,t.url_preview)}var i=setInterval(function(){(1==r||0==r&&a.find(".emojionearea").get(0))&&(clearInterval(i),n.attr("data-loaded","true"),n.removeClass("loading"),c.yz_show_modal(a))},100)}).fail(function(t,e,a){return n.removeClass("loading"),c.yz_DialogMsg("error",Youzer.unknown_error),!1})}}}),c(document).on("click",".yz-update-post",function(t){t.preventDefault();c(this).attr("data-activity-type");var a=c(this),i=c(this).text(),e=c(this).closest("#yz-wall-form"),n=d.parent().hasClass("activity-meta")||d.parent().hasClass("yz-activity-tools")?"activity":"comment",s={};if(!a.hasClass("loading")){a.addClass("loading"),a.html('<i class="fas fa-spinner fa-spin"></i>'),jQuery.each(e.serializeArray(),function(t,e){"_"!==e.name.substr(0,1)&&"whats-new"!==e.name.substr(0,9)&&(s[e.name]?jQuery.isArray(s[e.name])?s[e.name].push(e.value):s[e.name]=new Array(s[e.name],e.value):s[e.name]=e.value)});var o=c.extend({action:"yz_save_activity_edit_form",yz_edit_activity_nonce:e.find('input[name="yz_edit_activity_nonce"]').val(),activity_id:c(this).data("activity-id"),content:e.find(".yz-wall-textarea").val(),target:n},s);c.ajax({type:"POST",url:ajaxurl,data:o,success:function(t){if(c.yz_isJSON(t)){var e=c.parseJSON(t);if(e.error)return a.removeClass("loading"),a.text(i),e.remove_modal&&(c.yzea_hide_modal(a),d.remove()),void c.yz_DialogMsg("error",e.error)}"comment"==n&&e.content&&c("li#acomment-"+o.activity_id).find(".acomment-content").first().html("<p>"+e.content+"</p>").show(),"activity"==n&&(c("li#activity-"+o.activity_id).replaceWith(t),c("li#activity-"+o.activity_id).hasClass("activity_slideshow")&&c.youzer_sliders_init()),c.yzea_hide_modal(a)}})}}),c(document).on("click","#yz-edit-activity-form .yz-delete-attachment",function(t){var e=c(this).closest(".yz-attachment-item").attr("data-item-id");e&&c(document).find("#yz-edit-activity-form .yz-wall-attachments").append('<input type="hidden" name="delete_attachments[]" value="'+e+'" >')}),c.yzea_hide_modal=function(t){t.closest("#yz-modal").find(".yz-modal-close-icon").trigger("click")}})}(jQuery);